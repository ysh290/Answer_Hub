<view class="container">
  <!-- 欢迎区域 -->
  <view class="welcome-section">
    <view class="welcome-text">您好</view>
    <view class="welcome-subtitle">欢迎使用狗蛋答疑宝典~</view>
  </view>

  <!-- 标签页 -->
  <view class="tabs">
    <view 
      class="tab {{currentTab === 'login' ? 'active' : ''}}" 
      data-tab="login" 
      bindtap="switchTab"
    >
      登录
    </view>
    <view 
      class="tab {{currentTab === 'register' ? 'active' : ''}}" 
      data-tab="register" 
      bindtap="switchTab"
    >
      注册
    </view>
  </view>

  <!-- 登录表单 -->
  <view class="form-container" wx:if="{{currentTab === 'login'}}">
    <view class="login-form">
      <view class="input-group">
        <view class="input-label">手机号</view>
        <input 
          class="input-field" 
          type="number" 
          placeholder="请输入手机号"
          value="{{loginForm.phone}}"
          data-field="phone"
          bindinput="onLoginInput"
        />
      </view>

      <view class="input-group">
        <view class="input-label">密码</view>
        <view class="password-wrapper">
          <input 
            class="input-field" 
            type="password" 
            placeholder="请输入您的密码"
            value="{{loginForm.password}}"
            data-field="password"
            bindinput="onLoginInput"
          />
          <view class="forgot-password" bindtap="forgotPassword">
            <text class="lock-icon">🔒</text>
            <text>忘记密码?</text>
          </view>
        </view>
      </view>

      <view class="terms-checkbox">
        <view class="checkbox {{agreeTerms ? 'checked' : ''}}" bindtap="toggleAgreeTerms">
          <text class="checkbox-icon">{{agreeTerms ? '✓' : ''}}</text>
        </view>
        <text class="terms-text">我已阅读用户协议和隐私政策并同意相关条款内容</text>
      </view>

      <button class="submit-button" bindtap="login">登录</button>
      
      <!-- 微信快捷登录 -->
      <view class="wechat-login-section">
        <view class="divider">
          <view class="divider-line"></view>
          <text class="divider-text">或</text>
          <view class="divider-line"></view>
        </view>
        
        <button class="wechat-login-button" bindtap="wechatLogin">
          <text class="wechat-icon">💬</text>
          <text class="wechat-text">微信快捷登录</text>
        </button>
        
        <!-- 头像昵称填写组件 -->
        <view class="avatar-nickname-section" wx:if="{{showAvatarNickname}}">
          <view class="avatar-nickname-content">
            <view class="avatar-nickname-header">
              <view class="header-title">完善个人信息</view>
              <view class="header-subtitle">设置您的头像和昵称</view>
            </view>
            
            <view class="avatar-section">
              <button class="avatar-button" open-type="chooseAvatar" bindchooseavatar="onChooseAvatar">
                <view class="avatar-container">
                  <image class="avatar-image" src="{{tempAvatarUrl || '/static/user/用户.png'}}" mode="aspectFill"></image>
                  <view class="avatar-overlay">
                    <text class="avatar-icon">📷</text>
                  </view>
                </view>
                <text class="avatar-hint">点击设置头像</text>
              </button>
            </view>
            
            <view class="nickname-section">
              <input 
                class="nickname-input" 
                type="nickname" 
                placeholder="请输入您的昵称"
                value="{{tempNickname}}"
                bindinput="onNicknameInput"
                maxlength="20"
              />
            </view>
            
            <view class="action-buttons">
              <button class="cancel-btn" bindtap="cancelAvatarNickname">
                <text>取消</text>
              </button>
              <button class="confirm-btn" bindtap="confirmAvatarNickname">
                <text>完成</text>
              </button>
            </view>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- 注册表单 -->
  <view class="form-container" wx:if="{{currentTab === 'register'}}">
    <view class="register-form">
      <view class="input-group">
        <view class="input-label">手机号</view>
        <input 
          class="input-field" 
          type="number" 
          placeholder="请输入手机号"
          value="{{registerForm.phone}}"
          data-field="phone"
          bindinput="onRegisterInput"
        />
      </view>

      <view class="input-group">
        <view class="input-label">验证码</view>
        <view class="code-wrapper">
          <input 
            class="input-field code-input" 
            type="number" 
            placeholder="请输入收到的验证码"
            value="{{registerForm.code}}"
            data-field="code"
            bindinput="onRegisterInput"
          />
          <button 
            class="code-button {{countdown > 0 ? 'disabled' : ''}}" 
            bindtap="getCode"
            disabled="{{countdown > 0}}"
          >
            {{countdown > 0 ? countdown + 's' : '获取验证码'}}
          </button>
        </view>
      </view>

      <view class="input-group">
        <view class="input-label">昵称</view>
        <input 
          class="input-field" 
          type="text" 
          placeholder="请输入昵称"
          value="{{registerForm.nickname}}"
          data-field="nickname"
          bindinput="onRegisterInput"
        />
      </view>

      <view class="input-group">
        <view class="input-label">密码</view>
        <input 
          class="input-field" 
          type="password" 
          placeholder="请输入您的密码"
          value="{{registerForm.password}}"
          data-field="password"
          bindinput="onRegisterInput"
        />
      </view>

      <view class="input-group">
        <view class="input-label">确认密码</view>
        <input 
          class="input-field" 
          type="password" 
          placeholder="请输入您的密码"
          value="{{registerForm.confirmPassword}}"
          data-field="confirmPassword"
          bindinput="onRegisterInput"
        />
      </view>

      <view class="input-group">
        <view class="input-label">校区</view>
        <view class="picker-wrapper" bindtap="showCampusPicker">
          <text class="picker-text">{{registerForm.campus || '请选择校区'}}</text>
          <text class="picker-arrow">></text>
        </view>
      </view>

      <view class="input-group">
        <view class="input-label">考试类型</view>
        <view class="picker-wrapper" bindtap="showExamTypePicker">
          <text class="picker-text">{{registerForm.examType || '请选择考试类型'}}</text>
          <text class="picker-arrow">></text>
        </view>
      </view>

      <view class="terms-checkbox">
        <view class="checkbox {{agreeTerms ? 'checked' : ''}}" bindtap="toggleAgreeTerms">
          <text class="checkbox-icon">{{agreeTerms ? '✓' : ''}}</text>
        </view>
        <text class="terms-text">我已阅读用户协议和隐私政策并同意相关条款内容</text>
      </view>

      <button class="submit-button" bindtap="register">注册</button>
    </view>
  </view>
</view>

<!-- 校区选择器 -->
<picker 
  wx:if="{{showCampusPicker}}" 
  bindchange="onCampusChange" 
  bindcancel="showCampusPicker"
  range="{{campuses}}"
>
  <view></view>
</picker>

<!-- 考试类型选择器 -->
<picker 
  wx:if="{{showExamTypePicker}}" 
  bindchange="onExamTypeChange" 
  bindcancel="showExamTypePicker"
  range="{{examTypes}}"
>
  <view></view>
</picker>
